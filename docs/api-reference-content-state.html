<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>ContentState | qails</title><meta name="viewport" content="width=device-width"><link rel="stylesheet" href="/css/qails.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.34.4/es6-shim.min.js"></script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="/">qails</a><ul class="nav-site"><li><a href="/docs/overview.html#content" class="active">文档</a></li><li><a href="https://github.com/qailsjs/qails" class="">github</a></li></ul></div></div><section class="content wrap documentationContent"><div class="nav-docs"><div class="nav-docs-section"><h3>Quick Start</h3><ul><li><a style="margin-left:0;" class="" href="/docs/overview.html#content">Overview</a></li><li><a style="margin-left:0;" class="" href="/docs/quickstart-api-basics.html#content">API Basics</a></li><li><a style="margin-left:0;" class="" href="/docs/quickstart-rich-styling.html#content">Rich Styling</a></li></ul></div><div class="nav-docs-section"><h3>Advanced Topics</h3><ul><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-entities.html#content">Entities</a></li><li><a style="margin-left:0;" class="" href="/docs/v0-10-api-migration.html#content">v0.10 API Migration</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-decorators.html#content">Decorators</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-key-bindings.html#content">Key Bindings</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-managing-focus.html#content">Managing Focus</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-block-styling.html#content">Block Styling</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-custom-block-render-map.html#content">Custom Block Rendering</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-block-components.html#content">Custom Block Components</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-inline-styles.html#content">Complex Inline Styles</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-nested-lists.html#content">Nested Lists</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-text-direction.html#content">Text Direction</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-issues-and-pitfalls.html#content">Issues and Pitfalls</a></li></ul></div><div class="nav-docs-section"><h3>API Reference</h3><ul><li><a style="margin-left:0;" class="" href="/docs/api-reference-editor.html#content">Editor Component</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-editor-change-type.html#content">EditorChangeType</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-editor-state.html#content">EditorState</a></li><li><a style="margin-left:0;" class="active" href="/docs/api-reference-content-state.html#content">ContentState</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-content-block.html#content">ContentBlock</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-character-metadata.html#content">CharacterMetadata</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-entity.html#content">Entity</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-selection-state.html#content">SelectionState</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-composite-decorator.html#content">CompositeDecorator</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-data-conversion.html#content">Data Conversion</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-rich-utils.html#content">RichUtils</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-atomic-block-utils.html#content">AtomicBlockUtils</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-key-binding-util.html#content">KeyBindingUtil</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-modifier.html#content">Modifier</a></li></ul></div></div><div class="inner-content"><a id="content"></a><h1>ContentState</h1><div><p><code>ContentState</code> is an Immutable
<a href="http://facebook.github.io/immutable-js/docs/#/Record/Record" target="_blank">Record</a> that
represents the full state of:</p><ul><li>The entire <strong>contents</strong> of an editor: text, block and inline styles, and entity ranges.</li><li>Two <strong>selection states</strong> of an editor: before and after the rendering of these contents.</li></ul><p>The most common use for the <code>ContentState</code> object is via <code>EditorState.getCurrentContent()</code>,
which provides the <code>ContentState</code> currently being rendered in the editor.</p><p>An <code>EditorState</code> object maintains undo and redo stacks comprised of <code>ContentState</code>
objects.</p><h2><a class="anchor" name="overview"></a>Overview <a class="hash-link" href="#overview">#</a></h2><p><em>Static Methods</em></p><div><ul class="apiIndex">
  <li>
    <a href="#createfromtext">
      <pre>static createFromText(text: string): ContentState</pre>
    </a>
  </li>
  <li>
    <a href="#createfromblockarray">
      <pre>static createFromBlockArray(blocks: Array<ContentBlock>): ContentState</pre>
    </a>
  </li>
</ul>

</div><p><em>Methods</em></p><div><ul class="apiIndex">
  <li>
    <a href="#getentitymap">
      <pre>getEntityMap()</pre>
    </a>
  </li>
  <li>
    <a href="#getblockmap">
      <pre>getBlockMap()</pre>
    </a>
  </li>
  <li>
    <a href="#getselectionbefore">
      <pre>getSelectionBefore()</pre>
    </a>
  </li>
  <li>
    <a href="#getselectionafter">
      <pre>getSelectionAfter()</pre>
    </a>
  </li>
  <li>
    <a href="#getblockforkey">
      <pre>getBlockForKey(key)</pre>
    </a>
  </li>
  <li>
    <a href="#getkeybefore">
      <pre>getKeyBefore(key)</pre>
    </a>
  </li>
  <li>
    <a href="#getkeyafter">
      <pre>getKeyAfter(key)</pre>
    </a>
  </li>
  <li>
    <a href="#getblockbefore">
      <pre>getBlockBefore(key)</pre>
    </a>
  </li>
  <li>
    <a href="#getblockafter">
      <pre>getBlockAfter(key)</pre>
    </a>
  </li>
  <li>
    <a href="#getblocksasarray">
      <pre>getBlocksAsArray()</pre>
    </a>
  </li>
  <li>
    <a href="#getfirstblock">
      <pre>getFirstBlock()</pre>
    </a>
  </li>
  <li>
    <a href="#getlastblock">
      <pre>getLastBlock()</pre>
    </a>
  </li>
  <li>
    <a href="#getplaintext">
      <pre>getPlainText(delimiter)</pre>
    </a>
  </li>
  <li>
    <a href="#getlastcreatedentitykey">
      <pre>getLastCreatedEntityKey()</pre>
    </a>
  </li>
  <li>
    <a href="#hastext">
      <pre>hasText()</pre>
    </a>
  </li>
  <li>
    <a href="#createentity">
      <pre>createEntity(...)</pre>
    </a>
  </li>
  <li>
    <a href="#getentity">
      <pre>getEntity(...)</pre>
    </a>
  </li>
  <li>
    <a href="#mergeentitydata">
      <pre>mergeEntityData(...)</pre>
    </a>
  </li>
  <li>
    <a href="#replaceentitydata">
      <pre>replaceEntityData(...)</pre>
    </a>
  </li>
  <li>
    <a href="#addentity">
      <pre>addEntity(...)</pre>
    </a>
  </li>
</ul>

</div><p><em>Properties</em></p><blockquote><p>Use <a href="http://facebook.github.io/immutable-js/docs/#/Map" target="_blank">Immutable Map API</a> to
set properties.</p></blockquote><div><ul class="apiIndex">
  <li>
    <a href="#blockmap">
      <pre>blockMap</pre>
    </a>
  </li>
  <li>
    <a href="#selectionbefore">
      <pre>selectionBefore</pre>
    </a>
  </li>
  <li>
    <a href="#selectionafter">
      <pre>selectionAfter</pre>
    </a>
  </li>
</ul>

</div><h2><a class="anchor" name="static-methods"></a>Static Methods <a class="hash-link" href="#static-methods">#</a></h2><h3><a class="anchor" name="createfromtext"></a>createFromText <a class="hash-link" href="#createfromtext">#</a></h3><pre class="prism language-javascript">
static <span class="token function">createFromText<span class="token punctuation">(</span></span>
  text<span class="token punctuation">:</span> string<span class="token punctuation">,</span>
  delimiter<span class="token operator">?</span><span class="token punctuation">:</span> string
<span class="token punctuation">)</span><span class="token punctuation">:</span> ContentState</pre><p>Generates a <code>ContentState</code> from a string, with a delimiter to split the string
into <code>ContentBlock</code> objects. If no delimiter is provided, &#x27;<code>\n</code>&#x27; is used.</p><h3><a class="anchor" name="createfromblockarray"></a>createFromBlockArray <a class="hash-link" href="#createfromblockarray">#</a></h3><pre class="prism language-javascript">
static <span class="token function">createFromBlockArray<span class="token punctuation">(</span></span>
  blocks<span class="token punctuation">:</span> Array&lt;ContentBlock<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  entityMap<span class="token punctuation">:</span> <span class="token operator">?</span>OrderedMap
<span class="token punctuation">)</span><span class="token punctuation">:</span> ContentState</pre><p>Generates a <code>ContentState</code> from an array of <code>ContentBlock</code> objects. The default
<code>selectionBefore</code> and <code>selectionAfter</code> states have the cursor at the start of
the content.</p><h2><a class="anchor" name="methods"></a>Methods <a class="hash-link" href="#methods">#</a></h2><h3><a class="anchor" name="getentitymap"></a>getEntityMap <a class="hash-link" href="#getentitymap">#</a></h3><pre class="prism language-javascript">
<span class="token function">getEntityMap<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> EntityMap</pre><p>Returns an object store containing all <code>DraftEntity</code> records that have been
created.  In upcoming v0.11.0 the map returned will be an Immutable ordered map
of <code>DraftEntity</code> records.</p><p>In most cases, you should be able to use the convenience methods below to target
specific <code>DraftEntity</code> records or obtain information about the state of the
content.</p><h3><a class="anchor" name="getblockmap"></a>getBlockMap <a class="hash-link" href="#getblockmap">#</a></h3><pre class="prism language-javascript">
<span class="token function">getBlockMap<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> BlockMap</pre><p>Returns the full ordered map of <code>ContentBlock</code> objects representing the state
of an entire document.</p><p>In most cases, you should be able to use the convenience methods below to target
specific <code>ContentBlock</code> objects or obtain information about the state of the content.</p><h3><a class="anchor" name="getselectionbefore"></a>getSelectionBefore <a class="hash-link" href="#getselectionbefore">#</a></h3><pre class="prism language-javascript">
<span class="token function">getSelectionBefore<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> SelectionState</pre><p>Returns the <code>SelectionState</code> displayed in the editor before rendering <code>blockMap</code>.</p><p>When performing an <code>undo</code> action in the editor, the <code>selectionBefore</code> of the current
<code>ContentState</code> is used to place the selection range in the appropriate position.</p><h3><a class="anchor" name="getselectionafter"></a>getSelectionAfter <a class="hash-link" href="#getselectionafter">#</a></h3><pre class="prism language-javascript">
<span class="token function">getSelectionAfter<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> SelectionState</pre><p>Returns the <code>SelectionState</code> displayed in the editor after rendering <code>blockMap</code>.</p><p>When performing any action in the editor that leads to this <code>blockMap</code> being rendered,
the selection range will be placed in the <code>selectionAfter</code> position.</p><h3><a class="anchor" name="getblockforkey"></a>getBlockForKey <a class="hash-link" href="#getblockforkey">#</a></h3><pre class="prism language-javascript">
<span class="token function">getBlockForKey<span class="token punctuation">(</span></span>key<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> ContentBlock</pre><p>Returns the <code>ContentBlock</code> corresponding to the given block key.</p><h4><a class="anchor" name="example"></a>Example <a class="hash-link" href="#example">#</a></h4><pre class="prism language-javascript">
<span class="token keyword">var</span> <span class="token punctuation">{</span>editorState<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
<span class="token keyword">var</span> startKey <span class="token operator">=</span> editorState<span class="token punctuation">.</span><span class="token function">getSelection<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStartKey<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> selectedBlockType <span class="token operator">=</span> editorState
  <span class="token punctuation">.</span><span class="token function">getCurrentContent<span class="token punctuation">(</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">getBlockForKey<span class="token punctuation">(</span></span>startKey<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">getType<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><h3><a class="anchor" name="getkeybefore"></a>getKeyBefore <a class="hash-link" href="#getkeybefore">#</a></h3><pre class="prism language-javascript">
<span class="token function">getKeyBefore<span class="token punctuation">(</span></span>key<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">?</span>string</pre><p>Returns the key before the specified key in <code>blockMap</code>, or null if this is the first key.</p><h3><a class="anchor" name="getkeyafter"></a>getKeyAfter <a class="hash-link" href="#getkeyafter">#</a></h3><pre class="prism language-javascript">
<span class="token function">getKeyAfter<span class="token punctuation">(</span></span>key<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">?</span>string</pre><p>Returns the key after the specified key in <code>blockMap</code>, or null if this is the last key.</p><h3><a class="anchor" name="getblockbefore"></a>getBlockBefore <a class="hash-link" href="#getblockbefore">#</a></h3><pre class="prism language-javascript">
<span class="token function">getBlockBefore<span class="token punctuation">(</span></span>key<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">?</span>ContentBlock</pre><p>Returns the <code>ContentBlock</code> before the specified key in <code>blockMap</code>, or null if this is
the first key.</p><h3><a class="anchor" name="getblockafter"></a>getBlockAfter <a class="hash-link" href="#getblockafter">#</a></h3><pre class="prism language-javascript">
<span class="token function">getBlockAfter<span class="token punctuation">(</span></span>key<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">?</span>ContentBlock</pre><p>Returns the <code>ContentBlock</code> after the specified key in <code>blockMap</code>, or null if this is the last key.</p><h3><a class="anchor" name="getblocksasarray"></a>getBlocksAsArray <a class="hash-link" href="#getblocksasarray">#</a></h3><pre class="prism language-javascript">
<span class="token function">getBlocksAsArray<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> Array&lt;ContentBlock<span class="token operator">&gt;</span></pre><p>Returns the values of <code>blockMap</code> as an array.</p><p>You generally won&#x27;t need to use this method, since <code>getBlockMap</code> provides an <code>OrderedMap</code> that you should use for iteration.</p><h3><a class="anchor" name="getfirstblock"></a>getFirstBlock <a class="hash-link" href="#getfirstblock">#</a></h3><pre class="prism language-javascript">
<span class="token function">getFirstBlock<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> ContentBlock</pre><p>Returns the first <code>ContentBlock</code>.</p><h3><a class="anchor" name="getlastblock"></a>getLastBlock <a class="hash-link" href="#getlastblock">#</a></h3><pre class="prism language-javascript">
<span class="token function">getLastBlock<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> ContentBlock</pre><p>Returns the last <code>ContentBlock</code>.</p><h3><a class="anchor" name="getplaintext"></a>getPlainText <a class="hash-link" href="#getplaintext">#</a></h3><pre class="prism language-javascript">
<span class="token function">getPlainText<span class="token punctuation">(</span></span>delimiter<span class="token operator">?</span><span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> string</pre><p>Returns the full plaintext value of the contents, joined with a delimiter. If no
delimiter is specified, the line feed character (<code>\u000A</code>) is used.</p><h3><a class="anchor" name="getlastcreatedentitykey"></a>getLastCreatedEntityKey <a class="hash-link" href="#getlastcreatedentitykey">#</a></h3><pre class="prism language-javascript">
<span class="token function">getLastCreatedEntityKey<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> string</pre><p>Returns the string key that can be used to reference the most recently created
<code>DraftEntity</code> record. This is because entities are referenced by their string
key in ContentState. The string value should be used within CharacterMetadata
objects to track the entity for annotated characters.</p><h3><a class="anchor" name="hastext"></a>hasText <a class="hash-link" href="#hastext">#</a></h3><pre class="prism language-javascript">
<span class="token function">hasText<span class="token punctuation">(</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> boolean</pre><p>Returns whether the contents contain any text at all.</p><h3><a class="anchor" name="createentity"></a>createEntity <a class="hash-link" href="#createentity">#</a></h3><pre class="prism language-javascript">
<span class="token function">createEntity<span class="token punctuation">(</span></span>
  type<span class="token punctuation">:</span> DraftEntityType<span class="token punctuation">,</span>
  mutability<span class="token punctuation">:</span> DraftEntityMutability<span class="token punctuation">,</span>
  data<span class="token operator">?</span><span class="token punctuation">:</span> Object
<span class="token punctuation">)</span><span class="token punctuation">:</span> ContentState</pre><p>Returns <code>ContentState</code> record updated to include the newly created
DraftEntity record in it&#x27;s <code>EntityMap</code>. Call <code>getLastCreatedEntityKey</code> to get
the key of the newly created <code>DraftEntity</code> record.</p><h3><a class="anchor" name="getentity"></a>getEntity <a class="hash-link" href="#getentity">#</a></h3><pre class="prism language-javascript">
<span class="token function">getEntity<span class="token punctuation">(</span></span>key<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> DraftEntityInstance</pre><p>Returns the DraftEntityInstance for the specified key. Throws if no instance exists for that key.</p><h3><a class="anchor" name="mergeentitydata"></a>mergeEntityData <a class="hash-link" href="#mergeentitydata">#</a></h3><pre class="prism language-javascript">
<span class="token function">mergeEntityData<span class="token punctuation">(</span></span>
  key<span class="token punctuation">:</span> string<span class="token punctuation">,</span>
  toMerge<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>key<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> any<span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> ContentState</pre><p>Since DraftEntityInstance objects are immutable, you cannot update an entity&#x27;s
metadata through typical mutative means.</p><p>The mergeData method allows you to apply updates to the specified entity.</p><h3><a class="anchor" name="replaceentitydata"></a>replaceEntityData <a class="hash-link" href="#replaceentitydata">#</a></h3><pre class="prism language-javascript">
<span class="token function">replaceEntityData<span class="token punctuation">(</span></span>
  key<span class="token punctuation">:</span> string<span class="token punctuation">,</span>
  newData<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">[</span>key<span class="token punctuation">:</span> string<span class="token punctuation">]</span><span class="token punctuation">:</span> any<span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> ContentState</pre><p>The replaceData method is similar to the mergeData method, except it will totally discard the existing data value for the instance and replace it with the specified newData.</p><h3><a class="anchor" name="addentity"></a>addEntity <a class="hash-link" href="#addentity">#</a></h3><pre class="prism language-javascript">
<span class="token function">addEntity<span class="token punctuation">(</span></span>instance<span class="token punctuation">:</span> DraftEntityInstance<span class="token punctuation">)</span><span class="token punctuation">:</span> ContentState</pre><p>In most cases, you will use contentState.createEntity(). This is a convenience
method that you probably will not need in typical Draft usage.</p><p>The add function is useful in cases where the instances have already been
created, and now need to be added to the Entity store. This may occur in cases
where a vanilla JavaScript representation of a ContentState is being revived for
editing.</p><h2><a class="anchor" name="properties"></a>Properties <a class="hash-link" href="#properties">#</a></h2><blockquote><p>Use <a href="http://facebook.github.io/immutable-js/docs/#/Map" target="_blank">Immutable Map API</a> to
set properties.</p></blockquote><h3><a class="anchor" name="blockmap"></a>blockMap <a class="hash-link" href="#blockmap">#</a></h3><p>See <code>getBlockMap()</code>.</p><h3><a class="anchor" name="selectionbefore"></a>selectionBefore <a class="hash-link" href="#selectionbefore">#</a></h3><p>See <code>getSelectionBefore()</code>.</p><h3><a class="anchor" name="selectionafter"></a>selectionAfter <a class="hash-link" href="#selectionafter">#</a></h3><p>See <code>getSelectionAfter()</code>.</p></div><div class="docs-prevnext"><a class="docs-next" href="api-reference-content-block.html#content">Next →</a></div></div></section><footer class="wrap"><div class="right">© 2017</div></footer></div><div id="fb-root"></div></body></html>