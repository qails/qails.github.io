<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Custom Block Rendering | qails</title><meta name="viewport" content="width=device-width"><link rel="stylesheet" href="/css/qails.css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.34.4/es6-shim.min.js"></script></head><body><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href="/">qails</a><ul class="nav-site"><li><a href="/docs/overview.html#content" class="active">文档</a></li><li><a href="https://github.com/qailsjs/qails" class="">github</a></li></ul></div></div><section class="content wrap documentationContent"><div class="nav-docs"><div class="nav-docs-section"><h3>Quick Start</h3><ul><li><a style="margin-left:0;" class="" href="/docs/overview.html#content">Overview</a></li><li><a style="margin-left:0;" class="" href="/docs/quickstart-api-basics.html#content">API Basics</a></li><li><a style="margin-left:0;" class="" href="/docs/quickstart-rich-styling.html#content">Rich Styling</a></li></ul></div><div class="nav-docs-section"><h3>Advanced Topics</h3><ul><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-entities.html#content">Entities</a></li><li><a style="margin-left:0;" class="" href="/docs/v0-10-api-migration.html#content">v0.10 API Migration</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-decorators.html#content">Decorators</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-key-bindings.html#content">Key Bindings</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-managing-focus.html#content">Managing Focus</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-block-styling.html#content">Block Styling</a></li><li><a style="margin-left:0;" class="active" href="/docs/advanced-topics-custom-block-render-map.html#content">Custom Block Rendering</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-block-components.html#content">Custom Block Components</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-inline-styles.html#content">Complex Inline Styles</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-nested-lists.html#content">Nested Lists</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-text-direction.html#content">Text Direction</a></li><li><a style="margin-left:0;" class="" href="/docs/advanced-topics-issues-and-pitfalls.html#content">Issues and Pitfalls</a></li></ul></div><div class="nav-docs-section"><h3>API Reference</h3><ul><li><a style="margin-left:0;" class="" href="/docs/api-reference-editor.html#content">Editor Component</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-editor-change-type.html#content">EditorChangeType</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-editor-state.html#content">EditorState</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-content-state.html#content">ContentState</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-content-block.html#content">ContentBlock</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-character-metadata.html#content">CharacterMetadata</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-entity.html#content">Entity</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-selection-state.html#content">SelectionState</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-composite-decorator.html#content">CompositeDecorator</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-data-conversion.html#content">Data Conversion</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-rich-utils.html#content">RichUtils</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-atomic-block-utils.html#content">AtomicBlockUtils</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-key-binding-util.html#content">KeyBindingUtil</a></li><li><a style="margin-left:0;" class="" href="/docs/api-reference-modifier.html#content">Modifier</a></li></ul></div></div><div class="inner-content"><a id="content"></a><h1>Custom Block Rendering</h1><div><p>This article discusses how to customize Draft default block rendering.
The block rendering is used to define supported block types and their respective
renderers, as well as converting pasted content to known Draft block types.</p><p>When pasting content or when using the
<a href="/docs/api-reference-data-conversion.html#convertfromhtml" target="">convertFromHTML</a>
Draft will then convert the pasted content to the respective block rendering type
by matching the Draft block render map with the matched tag.</p><h2><a class="anchor" name="draft-default-block-render-map"></a>Draft default block render map <a class="hash-link" href="#draft-default-block-render-map">#</a></h2><table><thead><tr><th>HTML element</th><th>Draft block type</th></tr></thead><thead><tr><td><code>&lt;h1/&gt;</code></td><td>header-one</td></tr><tr><td><code>&lt;h2/&gt;</code></td><td>header-two</td></tr><tr><td><code>&lt;h3/&gt;</code></td><td>header-three</td></tr><tr><td><code>&lt;h4/&gt;</code></td><td>header-four</td></tr><tr><td><code>&lt;h5/&gt;</code></td><td>header-five</td></tr><tr><td><code>&lt;h6/&gt;</code></td><td>header-six</td></tr><tr><td><code>&lt;blockquote/&gt;</code></td><td>blockquote</td></tr><tr><td><code>&lt;pre/&gt;</code></td><td>code-block</td></tr><tr><td><code>&lt;figure/&gt;</code></td><td>atomic</td></tr><tr><td><code>&lt;li/&gt;</code></td><td>unordered-list-item,ordered-list-item**</td></tr><tr><td><code>&lt;div/&gt;</code></td><td>unstyled<em>*</em></td></tr></thead></table><p>** - Block type will be based on the parent <code>&lt;ul/&gt;</code> or <code>&lt;ol/&gt;</code></p><p>*** -  Any block that is not recognized by the block redering mapping will be treated as unstyled</p><h2><a class="anchor" name="configuring-block-render-map"></a>Configuring block render map <a class="hash-link" href="#configuring-block-render-map">#</a></h2><p>Draft default block render map can be overwritten, by passing an
<a href="http://facebook.github.io/immutable-js/docs/#/Map" target="_blank">Immutable Map</a> to
the editor blockRender props.</p><p><em>example of overwritting default block render map:</em></p><pre class="prism language-javascript">
<span class="token comment" spellcheck="true">// The example below deliberatly only allows
</span><span class="token comment" spellcheck="true">// &#x27;heading-two&#x27; as the only valid block type and
</span><span class="token comment" spellcheck="true">// updates the unstyled element to also become a h2.
</span>const blockRenderMap <span class="token operator">=</span> Immutable<span class="token punctuation">.</span><span class="token function">Map<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  <span class="token string">&#x27;header-two&#x27;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">:</span> <span class="token string">&#x27;h2&#x27;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&#x27;unstyled&#x27;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">:</span> <span class="token string">&#x27;h2&#x27;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

class <span class="token class-name">RichEditor</span> extends <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      &lt;Editor
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        blockRenderMap<span class="token operator">=</span><span class="token punctuation">{</span>blockRenderMap<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre><p>There are cases where instead of overwriting the defaults we just want to add new block types;
this can be done by using the DefaultDraftBlockRenderMap reference to create a new blockRenderMap</p><p><em>example of extending default block render map:</em></p><pre class="prism language-javascript">
const blockRenderMap <span class="token operator">=</span> Immutable<span class="token punctuation">.</span><span class="token function">Map<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  <span class="token string">&#x27;section&#x27;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    element<span class="token punctuation">:</span> <span class="token string">&#x27;section&#x27;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// Include &#x27;paragraph&#x27; as a valid block and updated the unstyled element but
</span><span class="token comment" spellcheck="true">// keep support for other draft default block types
</span>const extendedBlockRenderMap <span class="token operator">=</span> Draft<span class="token punctuation">.</span>DefaultDraftBlockRenderMap<span class="token punctuation">.</span><span class="token function">merge<span class="token punctuation">(</span></span>blockRenderMap<span class="token punctuation">)</span><span class="token punctuation">;</span>

class <span class="token class-name">RichEditor</span> extends <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      &lt;Editor
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        blockRenderMap<span class="token operator">=</span><span class="token punctuation">{</span>extendedBlockRenderMap<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre><p>When Draft parses pasted HTML, it maps from HTML elements back into
Draft block types. If you want to specify other HTML elements that map to a
particular block type, you can add an array <code>aliasedElements</code> to the block config.</p><p><em>example of unstyled block type alias usage:</em></p><pre class="prism language-javascript">
<span class="token string">&#x27;unstyled&#x27;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
  element<span class="token punctuation">:</span> <span class="token string">&#x27;div&#x27;</span><span class="token punctuation">,</span>
  aliasedElements<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&#x27;p&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></pre><h2><a class="anchor" name="custom-block-wrappers"></a>Custom block wrappers <a class="hash-link" href="#custom-block-wrappers">#</a></h2><p>By default the html element is used to wrap block types however a react component
can also be provided to the <em>blockRenderMap</em> to wrap the EditorBlock.</p><p>During pasting or when using the
<a href="/docs/api-reference-data-conversion.html#convertfromhtml" target="">convertFromHTML</a>
the html will be scanned for matching tag elements. A wrapper will be used when there is a definition for
it on the <em>blockRenderMap</em> to wrap that particular block type. For example:</p><p>Draft uses wrappers to wrap <code>&lt;li/&gt;</code> inside either <code>&lt;ol/&gt;</code> or <code>&lt;ul/&gt;</code> but wrappers can also be used
to wrap any other custom block type</p><p><em>example of extending default block render map to use a react component for a custom block:</em></p><pre class="prism language-javascript">
class <span class="token class-name">MyCustomBlock</span> extends <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor<span class="token punctuation">(</span></span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">super<span class="token punctuation">(</span></span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      &lt;div className<span class="token operator">=</span><span class="token string">&#x27;MyCustomBlock&#x27;</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* here, this.props.children contains a &lt;section&gt; container, as that was the matching element */</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span>
      &lt;<span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

const blockRenderMap <span class="token operator">=</span> Immutable<span class="token punctuation">.</span><span class="token function">Map<span class="token punctuation">(</span></span><span class="token punctuation">{</span>
  <span class="token string">&#x27;MyCustomBlock&#x27;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
   <span class="token comment" spellcheck="true"> // element is used during paste or html conversion to auto match your component;
</span>   <span class="token comment" spellcheck="true"> // it is also retained as part of this.props.children and not stripped out
</span>    element<span class="token punctuation">:</span> <span class="token string">&#x27;section&#x27;</span><span class="token punctuation">,</span>
    wrapper<span class="token punctuation">:</span> &lt;MyCustomBlock <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// keep support for other draft default block types and add our myCustomBlock type
</span>const extendedBlockRenderMap <span class="token operator">=</span> Draft<span class="token punctuation">.</span>DefaultDraftBlockRenderMap<span class="token punctuation">.</span><span class="token function">merge<span class="token punctuation">(</span></span>blockRenderMap<span class="token punctuation">)</span><span class="token punctuation">;</span>

class <span class="token class-name">RichEditor</span> extends <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token function">render<span class="token punctuation">(</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      &lt;Editor
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        blockRenderMap<span class="token operator">=</span><span class="token punctuation">{</span>extendedBlockRenderMap<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div><div class="docs-prevnext"><a class="docs-next" href="advanced-topics-block-components.html#content">Next →</a></div></div></section><footer class="wrap"><div class="right">© 2017</div></footer></div><div id="fb-root"></div></body></html>